\documentclass[a4paper,11pt]{article}
\usepackage[UTF8]{ctex} % æ”¯æŒä¸­æ–‡
\usepackage[margin=1in]{geometry}
\usepackage{hyperref}
\usepackage{xcolor}
\usepackage{listings}
\usepackage{amsmath}
\usepackage{tcolorbox}
\usepackage{booktabs}
\usepackage{graphicx}

% å®šä¹‰ä»£ç å—æ ·å¼
\lstset{
    language=SQL,
    basicstyle=\ttfamily\small,
    keywordstyle=\color{blue}\bfseries,
    commentstyle=\color{gray},
    stringstyle=\color{red},
    frame=single,
    breaklines=true,
    numbers=left,
    numberstyle=\tiny\color{gray},
    showstringspaces=false
}

% å®šä¹‰æç¤ºæ¡†æ ·å¼
\newtcolorbox{warningbox}{
    colback=red!5!white,
    colframe=red!75!black,
    title=\textbf{âš ï¸ æ˜“é”™ç‚¹ / Pitfall},
    fonttitle=\bfseries
}

\newtcolorbox{correctionbox}{
    colback=yellow!10!white,
    colframe=orange!85!black,
    title=\textbf{ğŸ’¡ ä¿®æ­£ä¸ç°ä»£è§‚ç‚¹ / Modern Practice},
    fonttitle=\bfseries
}

\title{\textbf{CS213 æ•°æ®åº“ç³»ç»ŸåŸç† (H) è¯¦ç»†Lecture Note}}
\author{åŸºäº Shiqi Yu (SUSTech) è®²ä¹‰æ•´ç†}
\date{\today}

\begin{document}

\maketitle
\tableofcontents
\newpage

\section{Chapter 1: æ•°æ®åº“ç³»ç»Ÿå¯¼è®º (Introduction to Databases)}

\subsection{1.1 æ•°æ®åº“ç³»ç»Ÿçš„æœ¬è´¨}
æ•°æ®åº“ç³»ç»Ÿä¸ä»…ä»…æ˜¯æ•°æ®çš„é›†åˆï¼Œå®ƒæ˜¯ä¸€ä¸ªè´Ÿè´£ç®¡ç†å¤§é‡ã€å¤æ‚ã€ç›¸å…³è”æ•°æ®çš„è½¯ä»¶ç³»ç»Ÿã€‚
\begin{itemize}
    \item \textbf{ç»„æˆè¦ç´ }ï¼š
    \begin{itemize}
        \item \textbf{æ•°æ® (Data)}ï¼šç›¸å…³è”çš„æ•°æ®é›†åˆã€‚
        \item \textbf{ç¨‹åº (Programs)}ï¼šä¸€ç»„ç”¨äºè®¿é—®å’Œæ“ä½œæ•°æ®çš„ç¨‹åºã€‚
        \item \textbf{ç¯å¢ƒ (Environment)}ï¼šä¸€ä¸ªæ—¢æ–¹ä¾¿åˆé«˜æ•ˆçš„ä½¿ç”¨ç¯å¢ƒã€‚
    \end{itemize}
    \item \textbf{å†å²æ¼”å˜}ï¼š
    \begin{itemize}
        \item \textbf{æ—©æœŸ (File Systems)}ï¼šæ•°æ®ç›´æ¥å­˜å‚¨åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ã€‚å­˜åœ¨æ•°æ®å†—ä½™ã€ä¸ä¸€è‡´ã€è®¿é—®å›°éš¾ã€åŸå­æ€§ç¼ºå¤±ã€å¹¶å‘è®¿é—®å›°éš¾åŠå®‰å…¨é—®é¢˜ã€‚
        \item \textbf{1970å¹´}ï¼šEdgar F. Codd å‘è¡¨äº†åˆ’æ—¶ä»£çš„è®ºæ–‡ \textit{"A Relational Model of Data for Large Shared Data Banks"}ï¼Œæå‡ºäº†å…³ç³»æ¨¡å‹ã€‚
        \item \textbf{1980s}ï¼šSQL æˆä¸ºå·¥ä¸šæ ‡å‡†ï¼›å…³ç³»å‹æ•°æ®åº“ (RDBMS) å•†ä¸šåŒ–ï¼ˆå¦‚ Oracle, DB2ï¼‰ã€‚
        \item \textbf{2000s}ï¼šå¤§æ•°æ®æ—¶ä»£ï¼ŒNoSQL ç³»ç»Ÿï¼ˆå¦‚ Google BigTable, Amazon Dynamoï¼‰å…´èµ·ï¼Œç”¨äºå¤„ç†éç»“æ„åŒ–æ•°æ®å’Œè¶…å¤§è§„æ¨¡æ•°æ®ï¼›MapReduce æµè¡Œã€‚
        \item \textbf{2010s}ï¼šNewSQL å‡ºç°ï¼Œè¯•å›¾ç»“åˆ NoSQL çš„å¯æ‰©å±•æ€§å’Œ SQL çš„ ACID ç‰¹æ€§ï¼›å¤šæ ¸å†…å­˜æ•°æ®åº“æˆä¸ºè¶‹åŠ¿ã€‚
    \end{itemize}
\end{itemize}

\subsection{1.2 å…³ç³»æ¨¡å‹ (Relational Model)}
\begin{itemize}
    \item \textbf{å…³ç³» (Relation)}ï¼šå³â€œè¡¨â€(Table)ã€‚
    \item \textbf{å…ƒç»„ (Tuple)}ï¼šè¡¨ä¸­çš„ä¸€è¡Œ (Row/Record)ï¼Œä»£è¡¨ä¸€ä¸ªå®ä½“æˆ–äº‹å®ã€‚
    \item \textbf{å±æ€§ (Attribute)}ï¼šè¡¨ä¸­çš„ä¸€åˆ— (Column)ï¼Œä»£è¡¨æ•°æ®çš„ä¸€ä¸ªç‰¹å¾ã€‚
    \item \textbf{æ ¸å¿ƒæ€æƒ³}ï¼šè¡¨ä¸­çš„ä¸€è¡Œæ•°æ®æ˜¯ç›¸äº’å…³è”çš„ (related)ï¼Œå³â€œå…³ç³»â€ä¸€è¯çš„ç”±æ¥ã€‚
    \item \textbf{é›†åˆè®ºåŸºç¡€}ï¼šå…³ç³»æ˜¯æ•°å­¦ä¸Šçš„é›†åˆï¼Œå› æ­¤å¯ä»¥å¯¹è¡¨è¿›è¡Œé›†åˆè¿ç®—ï¼ˆé€‰æ‹©ã€æŠ•å½±ã€è¿æ¥ç­‰ï¼‰ä»è€Œäº§ç”Ÿæ–°çš„è¡¨ã€‚
\end{itemize}

\subsection{1.3 é”® (Keys)}
åœ¨å…³ç³»æ¨¡å‹ä¸­ï¼Œ\textbf{ä¸å…è®¸å­˜åœ¨é‡å¤çš„è¡Œ} (No duplicates)ã€‚ä¸ºäº†åŒºåˆ†ä¸åŒçš„è¡Œï¼Œéœ€è¦ä½¿ç”¨â€œé”®â€ã€‚
\begin{itemize}
    \item \textbf{è¶…é”® (Super Key)}ï¼šèƒ½å”¯ä¸€æ ‡è¯†ä¸€ä¸ªå…ƒç»„çš„ä¸€ä¸ªæˆ–å¤šä¸ªå±æ€§çš„é›†åˆã€‚
    \item \textbf{å€™é€‰é”® (Candidate Key)}ï¼šæœ€å°çš„è¶…é”®ï¼ˆæ²¡æœ‰å¤šä½™å±æ€§ï¼‰ã€‚
    \item \textbf{ä¸»é”® (Primary Key, PK)}ï¼šè¢«æ•°æ®åº“è®¾è®¡è€…é€‰ä¸­ç”¨æ¥ä½œä¸ºä¸»è¦æ ‡è¯†ç¬¦çš„å€™é€‰é”®ã€‚é€šå¸¸é€‰æ‹©æœ€ç®€å•ã€æœ€ç¨³å®šçš„é‚£ä¸ªã€‚
    \end{itemize}

\begin{warningbox}
è™½ç„¶ç†è®ºä¸Šå…³ç³»é›†åˆä¸å…è®¸é‡å¤è¡Œï¼Œä½†åœ¨å®é™…çš„ SQL æ•°æ®åº“å®ç°ä¸­ï¼Œå¦‚æœæ²¡æœ‰æ˜¾å¼å®šä¹‰ä¸»é”®æˆ–å”¯ä¸€çº¦æŸï¼Œè¡¨æ˜¯å¯ä»¥åŒ…å«å®Œå…¨é‡å¤çš„è¡Œçš„ï¼ˆè¿™è¢«ç§°ä¸º bag è€Œä¸æ˜¯ setï¼‰ã€‚è¿™åœ¨æ•°æ®å¤„ç†ä¸­é€šå¸¸æ˜¯ä¸è‰¯è®¾è®¡ã€‚
\end{warningbox}

\subsection{1.4 èŒƒå¼ (Normalization)}
èŒƒå¼åŒ–æ˜¯ç»„ç»‡æ•°æ®ä»¥å‡å°‘å†—ä½™å’Œä¾èµ–çš„è¿‡ç¨‹ã€‚
\begin{itemize}
    \item \textbf{ç¬¬ä¸€èŒƒå¼ (1NF)}ï¼šå±æ€§å¿…é¡»æ˜¯åŸå­çš„ (Atomic)ã€‚
    \begin{itemize}
        \item é”™è¯¯ç¤ºä¾‹ï¼šä¸€ä¸ªå•å…ƒæ ¼å†…å­˜æ”¾ "Zhang San, Li Si"ã€‚
        \item æ­£ç¡®åšæ³•ï¼šä¸€è¡Œåªå­˜ä¸€ä¸ªåå­—ï¼Œæˆ–è€…åˆ†æ‹†æˆå¤šè¡Œã€‚
    \end{itemize}
    \item \textbf{ç¬¬äºŒèŒƒå¼ (2NF)}ï¼šæ»¡è¶³ 1NFï¼Œä¸”éä¸»å±æ€§å¿…é¡»\textbf{å®Œå…¨ä¾èµ–}äºä¸»é”®ï¼ˆæ¶ˆé™¤éƒ¨åˆ†ä¾èµ–ï¼‰ã€‚
    \begin{itemize}
        \item å¦‚æœä¸»é”®æ˜¯ (StudentId, CourseId)ï¼Œé‚£ä¹ˆ "StudentName" ä¸åº”è¯¥æ”¾åœ¨è¿™å¼ è¡¨é‡Œï¼Œå› ä¸ºå®ƒåªä¾èµ–äº StudentIdï¼Œè€Œä¸ä¾èµ–äº CourseIdã€‚
    \end{itemize}
    \item \textbf{ç¬¬ä¸‰èŒƒå¼ (3NF)}ï¼šæ»¡è¶³ 2NFï¼Œä¸”éä¸»å±æ€§ä¸ä¾èµ–äºå…¶ä»–éä¸»å±æ€§ï¼ˆæ¶ˆé™¤ä¼ é€’ä¾èµ–ï¼‰ã€‚
    \begin{itemize}
        \item ä¾‹å¦‚ï¼š(MovieId, DirectorId, DirectorName)ã€‚DirectorName ä¾èµ–äº DirectorIdï¼Œè€Œ DirectorId ä¾èµ–äº MovieIdã€‚è¿™æ„æˆäº†ä¼ é€’ä¾èµ–ï¼Œåº”è¯¥æ‹†åˆ†ä¸ºä¸¤å¼ è¡¨ã€‚
    \end{itemize}
\end{itemize}

\section{Chapter 2: SQL åŸºç¡€ (Introduction to SQL)}

\subsection{2.1 SQL è¯­è¨€æ¦‚è§ˆ}
SQL (Structured Query Language) èµ·æºäº IBM çš„ SEQUEL é¡¹ç›®ï¼Œæ—¨åœ¨æä¾›ä¸€ç§ç±»ä¼¼è‹±è¯­çš„ç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€ã€‚
\begin{itemize}
    \item \textbf{DDL (Data Definition Language)}ï¼šå®šä¹‰æ•°æ®ç»“æ„ã€‚æ ¸å¿ƒæŒ‡ä»¤ï¼š\texttt{CREATE}, \texttt{ALTER}, \texttt{DROP}ã€‚
    \item \textbf{DML (Data Manipulation Language)}ï¼šæ“ä½œæ•°æ®å†…å®¹ã€‚æ ¸å¿ƒæŒ‡ä»¤ï¼š\texttt{INSERT}, \texttt{UPDATE}, \texttt{DELETE}, \texttt{SELECT}ã€‚
\end{itemize}

\begin{correctionbox}
SQL æ˜¯ä¸€ç§å£°æ˜å¼è¯­è¨€ (Declarative)ï¼Œä½ å‘Šè¯‰æ•°æ®åº“\textbf{ä½ æƒ³è¦ä»€ä¹ˆ (What)}ï¼Œè€Œä¸æ˜¯\textbf{æ€ä¹ˆåš (How)}ã€‚ä½†åœ¨æ€§èƒ½è°ƒä¼˜æ—¶ï¼Œç†è§£åº•å±‚çš„â€œæ€ä¹ˆåšâ€ï¼ˆæ‰§è¡Œè®¡åˆ’ï¼‰è‡³å…³é‡è¦ã€‚
\end{correctionbox}

\subsection{2.2 åˆ›å»ºè¡¨ (CREATE TABLE)}
\begin{lstlisting}
CREATE TABLE table_name (
    column1 datatype [constraints],
    column2 datatype [constraints],
    ...
);
\end{lstlisting}
\begin{itemize}
    \item \textbf{æ ‡è¯†ç¬¦è§„åˆ™}ï¼šè¡¨åå’Œåˆ—åé€šå¸¸ä¸åŒºåˆ†å¤§å°å†™ï¼ˆCase-insensitiveï¼‰ã€‚å»ºè®®ä½¿ç”¨ä¸‹åˆ’çº¿å‘½åæ³•ï¼ˆsnake\_caseï¼‰ï¼Œé¿å…ä½¿ç”¨ç©ºæ ¼æˆ–ä¿ç•™å­—ã€‚
    \item \textbf{æ•°æ®ç±»å‹ (Data Types)}ï¼š
    \begin{itemize}
        \item \textbf{æ–‡æœ¬}ï¼š\texttt{CHAR(n)} (å®šé•¿ï¼Œä¸è¶³è¡¥ç©ºæ ¼), \texttt{VARCHAR(n)} (å˜é•¿), \texttt{CLOB/TEXT} (å¤§æ–‡æœ¬)ã€‚
        \begin{warningbox}
        Oracle ä¸­ \texttt{VARCHAR2} æ˜¯æ¨èç±»å‹ï¼Œç©ºå­—ç¬¦ä¸² \texttt{''} åœ¨ Oracle ä¸­è¢«è§†ä¸º \texttt{NULL}ï¼Œè¿™ä¸å…¶ä»–æ•°æ®åº“ä¸åŒã€‚
        \end{warningbox}
        \item \textbf{æ•°å­—}ï¼š\texttt{INT}, \texttt{FLOAT}, \texttt{NUMERIC(p,s)} / \texttt{DECIMAL(p,s)} (pä¸ºæ€»ä½æ•°ï¼Œsä¸ºå°æ•°ä½)ã€‚
        \item \textbf{æ—¥æœŸ}ï¼š\texttt{DATE} (é€šå¸¸å«æ—¶é—´ï¼ŒOracle/MySQLä¸åŒ), \texttt{TIMESTAMP} (æ›´é«˜ç²¾åº¦), \texttt{DATETIME} (SQL Server)ã€‚
    \end{itemize}
\end{itemize}

\subsection{2.3 çº¦æŸ (Constraints)}
çº¦æŸæ˜¯ä¿è¯æ•°æ®ä¸€è‡´æ€§å’Œæ­£ç¡®æ€§çš„å…³é”®æœºåˆ¶ã€‚
\begin{itemize}
    \item \textbf{NOT NULL}ï¼šåˆ—å€¼ä¸èƒ½ä¸ºç©ºã€‚
    \item \textbf{PRIMARY KEY}ï¼šå”¯ä¸€æ ‡è¯†è¡Œï¼Œéšå« NOT NULL å’Œ UNIQUEã€‚
    \item \textbf{UNIQUE}ï¼šåˆ—å€¼å¿…é¡»å”¯ä¸€ï¼ˆä½†é€šå¸¸å…è®¸æœ‰å¤šä¸ª NULLï¼Œè§† DBMS è€Œå®šï¼‰ã€‚
    \item \textbf{CHECK}ï¼šè‡ªå®šä¹‰é€»è¾‘æ ¡éªŒï¼ˆä¾‹å¦‚ \texttt{year > 1900}ï¼‰ã€‚
    \begin{correctionbox}
    MySQL åœ¨ 8.0.16 ç‰ˆæœ¬ä¹‹å‰ä¼šå¿½ç•¥ CHECK çº¦æŸï¼Œè¿™åœ¨å½“æ—¶æ˜¯ä¸€ä¸ªä¸»è¦ç¼ºé™·ã€‚ç°åœ¨çš„ç‰ˆæœ¬å·²æ”¯æŒã€‚
    \end{correctionbox}
    \item \textbf{FOREIGN KEY (Referential Integrity)}ï¼šç¡®ä¿å¼•ç”¨çš„å€¼åœ¨çˆ¶è¡¨ä¸­å­˜åœ¨ã€‚
    \begin{itemize}
        \item è¯­æ³•ï¼š\texttt{FOREIGN KEY (col) REFERENCES other\_table(col)}ã€‚
        \item ä½œç”¨ï¼šé˜²æ­¢å‡ºç°â€œå­¤å„¿æ•°æ®â€ã€‚åˆ é™¤çˆ¶è¡¨æ•°æ®æ—¶ï¼Œå¦‚æœå­è¡¨æœ‰å¼•ç”¨ï¼Œæ•°æ®åº“ä¼šæŠ¥é”™æˆ–çº§è”åˆ é™¤ï¼ˆéœ€é…ç½®ï¼‰ã€‚
    \end{itemize}
\end{itemize}

\subsection{2.4 æ’å…¥æ•°æ® (INSERT)}
\begin{lstlisting}
INSERT INTO table_name (col1, col2) VALUES (val1, val2);
\end{lstlisting}
\begin{itemize}
    \item \textbf{å­—ç¬¦ä¸²å¼•ç”¨}ï¼šæ ‡å‡† SQL ä½¿ç”¨\textbf{å•å¼•å·} \texttt{'string'}ã€‚
    \item \textbf{è½¬ä¹‰å¼•å·}ï¼šåœ¨å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºå•å¼•å·ï¼Œé€šå¸¸ä½¿ç”¨åŒå†™å•å¼•å· \texttt{'It''s ok'}ã€‚
    \item \textbf{æ—¥æœŸè¾“å…¥}ï¼šå¼ºçƒˆå»ºè®®ä½¿ç”¨æ ¼å¼è½¬æ¢å‡½æ•°ï¼ˆå¦‚ \texttt{TO\_DATE} æˆ– \texttt{DATE()}ï¼‰æ˜¾å¼è¾“å…¥æ—¥æœŸï¼Œä¸è¦ä¾èµ–éšå¼è½¬æ¢ï¼Œå› ä¸ºä¸åŒåœ°åŒºçš„æ—¥æœŸæ ¼å¼ï¼ˆDD/MM/YYYY vs MM/DD/YYYYï¼‰ææ˜“æ··æ·†ã€‚
\end{itemize}

\section{Chapter 3: å•è¡¨æŸ¥è¯¢ (Retrieving Data from One Table)}

\subsection{3.1 SELECT åŸºç¡€}
\begin{itemize}
    \item \texttt{SELECT *}ï¼šæ£€ç´¢æ‰€æœ‰åˆ—ã€‚
    \begin{warningbox}
    \textbf{ç¨‹åºå¼€å‘ç¦å¿Œ}ï¼šåœ¨ç”Ÿäº§ä»£ç ä¸­å°½é‡é¿å…ä½¿ç”¨ \texttt{SELECT *}ã€‚å¦‚æœè¡¨ç»“æ„å˜æ›´ï¼ˆå¢åŠ åˆ—ï¼‰ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç¨‹åºå´©æºƒæˆ–ä¸ä»…æµªè´¹ç½‘ç»œå¸¦å®½ã€‚åº”æ˜¾å¼åˆ—å‡ºéœ€è¦çš„åˆ—åã€‚
    \end{warningbox}
    \item \textbf{æŠ•å½± (Projection)}ï¼šé€‰æ‹©ç‰¹å®šçš„åˆ—ã€‚
    \item \textbf{é€‰æ‹© (Selection/Restriction)}ï¼šä½¿ç”¨ \texttt{WHERE} å­å¥ç­›é€‰è¡Œã€‚
\end{itemize}

\subsection{3.2 è¿‡æ»¤ä¸è¿ç®—ç¬¦ (WHERE Clause)}
\begin{itemize}
    \item \textbf{æ¯”è¾ƒç¬¦}ï¼š\texttt{=}, \texttt{<>} (æˆ– \texttt{!=}), \texttt{<}, \texttt{>}, \texttt{<=}, \texttt{>=}ã€‚
    \item \textbf{é€»è¾‘ç¬¦}ï¼š\texttt{AND}, \texttt{OR}, \texttt{NOT}ã€‚
    \begin{itemize}
        \item \textbf{ä¼˜å…ˆçº§}ï¼š\texttt{AND} çš„ä¼˜å…ˆçº§é«˜äº \texttt{OR}ã€‚æ··åˆä½¿ç”¨æ—¶åŠ¡å¿…ä½¿ç”¨æ‹¬å· \texttt{()} æ˜ç¡®æ„å›¾ã€‚
    \end{itemize}
    \item \textbf{èŒƒå›´ä¸åˆ—è¡¨}ï¼š\texttt{BETWEEN a AND b} (åŒ…å«è¾¹ç•Œ), \texttt{IN (a, b, c)}ã€‚
    \item \textbf{æ¨¡ç³ŠåŒ¹é…}ï¼š\texttt{LIKE}ã€‚
    \begin{itemize}
        \item \texttt{\%}ï¼šåŒ¹é…ä»»æ„é•¿åº¦å­—ç¬¦ï¼ˆåŒ…æ‹¬0ä¸ªï¼‰ã€‚
        \item \texttt{\_}ï¼šåŒ¹é…ä»»æ„å•ä¸ªå­—ç¬¦ã€‚
        \item å¤§å°å†™æ•æ„Ÿæ€§å–å†³äº DBMS å’Œ Collation è®¾ç½®ã€‚
    \end{itemize}
\end{itemize}

\subsection{3.3 NULL çš„é™·é˜±}
\begin{warningbox}
\textbf{NULL ä¸ç­‰äº NULL}ã€‚
\end{warningbox}
\begin{itemize}
    \item NULL ä»£è¡¨â€œæœªçŸ¥â€æˆ–â€œä¸å­˜åœ¨â€ã€‚
    \item ä»»ä½•ä¸ NULL è¿›è¡Œçš„æ¯”è¾ƒè¿ç®—ï¼ˆ\texttt{=}, \texttt{!=}, \texttt{>}, \texttt{<}ï¼‰ç»“æœéƒ½æ˜¯ \textbf{Unknown}ï¼ˆåœ¨ SQL ä¸­ä¼šè¢«è§†ä¸º Falseï¼‰ã€‚
    \item \textbf{é”™è¯¯å†™æ³•}ï¼š\texttt{WHERE col = NULL} ï¼ˆæ°¸è¿œä¸è¿”å›ä»»ä½•è¡Œï¼‰ã€‚
    \item \textbf{æ­£ç¡®å†™æ³•}ï¼š\texttt{WHERE col IS NULL} æˆ– \texttt{WHERE col IS NOT NULL}ã€‚
    \item \textbf{ä¸‰å€¼é€»è¾‘}ï¼šTRUE, FALSE, UNKNOWNã€‚æ³¨æ„ \texttt{NOT UNKNOWN} ä»ç„¶æ˜¯ \texttt{UNKNOWN}ã€‚
\end{itemize}

\subsection{3.4 å‡½æ•°ä¸è½¬æ¢}
\begin{itemize}
    \item \textbf{å­—ç¬¦ä¸²}ï¼š\texttt{UPPER()}, \texttt{LOWER()}, \texttt{SUBSTR()}, è¿æ¥ç¬¦ \texttt{||} (ANSI) æˆ– \texttt{+} (SQL Server) æˆ– \texttt{CONCAT()}ã€‚
    \item \textbf{æ—¥æœŸ}ï¼šæ—¥æœŸè¿ç®—æå…¶ä¾èµ– DBMSã€‚
    \begin{itemize}
        \item \texttt{DATEADD}, \texttt{DATEDIFF} (SQL Server)ã€‚
        \item \texttt{date + interval '1' day} (PostgreSQL/MySQL)ã€‚
        \item æ¯”è¾ƒ \texttt{DATETIME} å’Œ \texttt{DATE} æ—¶è¦æ³¨æ„æ—¶é—´éƒ¨åˆ†å¯èƒ½å¯¼è‡´ç›¸ç­‰åˆ¤æ–­å¤±è´¥ã€‚
    \end{itemize}
    \item \textbf{ç±»å‹è½¬æ¢}ï¼š\texttt{CAST(col AS type)} æ˜¯æ ‡å‡†è¯­æ³•ã€‚éšå¼è½¬æ¢ï¼ˆå¦‚å­—ç¬¦ä¸²ä¸æ•°å­—æ¯”è¾ƒï¼‰å¯èƒ½å¯¼è‡´æ€§èƒ½é—®é¢˜ï¼ˆç´¢å¼•å¤±æ•ˆï¼‰ã€‚
\end{itemize}

\subsection{3.5 CASE è¡¨è¾¾å¼}
ç”¨äºåœ¨ SQL ä¸­å®ç° if-else é€»è¾‘ã€‚
\begin{lstlisting}
CASE 
    WHEN condition1 THEN result1
    WHEN condition2 THEN result2
    ELSE result3
END
\end{lstlisting}
æˆ–è€…ï¼š
\begin{lstlisting}
CASE column
    WHEN val1 THEN res1
    ELSE res2
END
\end{lstlisting}
\textbf{æ³¨æ„}ï¼šå¦‚æœçœç•¥ \texttt{ELSE} ä¸”æ²¡æœ‰åŒ¹é…é¡¹ï¼Œé»˜è®¤è¿”å› \texttt{NULL}ã€‚

\section{Chapter 4: èšåˆä¸è¿æ¥ (Aggregation and Joins)}

\subsection{4.1 å»é‡ (DISTINCT)}
\begin{itemize}
    \item \texttt{SELECT DISTINCT col1, col2 ...}ï¼šå»é™¤ç»“æœé›†ä¸­æ‰€æœ‰æŒ‡å®šåˆ—ç»„åˆå®Œå…¨ç›¸åŒçš„é‡å¤è¡Œã€‚
    \item è¿™ä¼šå°†ç»“æœé›†è½¬åŒ–ä¸ºçœŸæ­£æ„ä¹‰ä¸Šçš„â€œå…³ç³»â€ï¼ˆé›†åˆï¼‰ã€‚
\end{itemize}

\subsection{4.2 èšåˆå‡½æ•° (Aggregate Functions)}
\begin{itemize}
    \item \textbf{å¸¸è§å‡½æ•°}ï¼š\texttt{COUNT(*)} (ç»Ÿè®¡æ‰€æœ‰è¡Œ), \texttt{COUNT(col)} (ç»Ÿè®¡éNULLå€¼), \texttt{SUM()}, \texttt{AVG()}, \texttt{MIN()}, \texttt{MAX()}ã€‚
    \item \textbf{NULLå¤„ç†}ï¼šèšåˆå‡½æ•°ï¼ˆé™¤ \texttt{COUNT(*)} å¤–ï¼‰ä¼šè‡ªåŠ¨å¿½ç•¥ NULL å€¼ã€‚
    \item \textbf{GROUP BY}ï¼šå°†æ•°æ®åˆ†ç»„ï¼Œå¯¹æ¯ç»„åº”ç”¨èšåˆå‡½æ•°ã€‚
    \begin{warningbox}
    \textbf{SELECT åˆ—è¡¨é™åˆ¶}ï¼šåœ¨ä½¿ç”¨ \texttt{GROUP BY} æ—¶ï¼ŒSELECT å­å¥ä¸­åªèƒ½åŒ…å«èšåˆå‡½æ•°æˆ– \texttt{GROUP BY} ä¸­åˆ—å‡ºçš„åˆ—ã€‚ä¸èƒ½é€‰æ‹©éåˆ†ç»„åˆ—ï¼Œå› ä¸ºå®ƒä»¬çš„å€¼æ˜¯ä¸ç¡®å®šçš„ã€‚
    \end{warningbox}
    \item \textbf{HAVING}ï¼šå¯¹\textbf{åˆ†ç»„å}çš„ç»“æœè¿›è¡Œè¿‡æ»¤ï¼ˆä¾‹å¦‚ï¼šç­›é€‰å‡ºå¹³å‡åˆ†å¤§äº60çš„ç­çº§ï¼‰ã€‚\texttt{WHERE} æ˜¯åœ¨åˆ†ç»„å‰è¿‡æ»¤ã€‚
\end{itemize}

\subsection{4.3 è¿æ¥ (Joins)}
è¿æ¥æ˜¯å°†å¤šå¼ è¡¨çš„æ•°æ®ç»“åˆèµ·æ¥çš„æ ¸å¿ƒæ“ä½œã€‚
\begin{itemize}
    \item \textbf{å†…è¿æ¥ (INNER JOIN)}ï¼šä»…è¿”å›ä¸¤å¼ è¡¨ä¸­æ»¡è¶³è¿æ¥æ¡ä»¶çš„è¡Œã€‚
    \item \textbf{è¯­æ³•æ¼”å˜}ï¼š
    \begin{correctionbox}
    \textbf{æ˜¾å¼ JOIN (ANSI-92) vs éšå¼ JOIN (ANSI-89)}ï¼š
    è®²ä¹‰ä¸­æåˆ°äº†ä½¿ç”¨ \texttt{FROM A, B WHERE A.id = B.id} çš„å†™æ³•ã€‚
    \textbf{ç°ä»£æœ€ä½³å®è·µ}ï¼šå¼ºçƒˆå»ºè®®ä½¿ç”¨ \texttt{FROM A JOIN B ON A.id = B.id}ã€‚
    åŸå› ï¼š
    1. åˆ†ç¦»äº†è¿æ¥é€»è¾‘ (ON) å’Œè¿‡æ»¤é€»è¾‘ (WHERE)ï¼Œå¯è¯»æ€§æ›´é«˜ã€‚
    2. é˜²æ­¢æ„å¤–é—æ¼ WHERE æ¡ä»¶å¯¼è‡´ç¬›å¡å°”ç§¯ (Cartesian Product)ï¼Œé€ æˆæ€§èƒ½ç¾éš¾ã€‚
    \end{correctionbox}
    \item \textbf{å¤šè¡¨è¿æ¥}ï¼šå¯ä»¥é“¾å¼è¿›è¡Œ \texttt{JOIN ... ON ... JOIN ... ON ...}ã€‚
\end{itemize}

\section{Chapter 5: é«˜çº§è¿æ¥ä¸å­æŸ¥è¯¢ (Advanced Joins and Subqueries)}

\subsection{5.1 å¤–è¿æ¥ (Outer Joins)}
\begin{itemize}
    \item \textbf{LEFT OUTER JOIN}ï¼šè¿”å›å·¦è¡¨çš„æ‰€æœ‰è¡Œã€‚å¦‚æœå³è¡¨æ²¡æœ‰åŒ¹é…ï¼Œå³è¡¨çš„åˆ—æ˜¾ç¤ºä¸º NULLã€‚
    \item \textbf{RIGHT OUTER JOIN}ï¼šè¿”å›å³è¡¨çš„æ‰€æœ‰è¡Œï¼ˆä¸å¸¸ç”¨ï¼Œé€šå¸¸ä¹ æƒ¯æ”¹å†™ä¸º LEFT JOINï¼‰ã€‚
    \item \textbf{FULL OUTER JOIN}ï¼šè¿”å›ä¸¤å¼ è¡¨çš„æ‰€æœ‰è¡Œï¼Œä»»ä¸€è¾¹ä¸åŒ¹é…åˆ™è¡¥ NULLï¼ˆMySQL ä¸ç›´æ¥æ”¯æŒï¼Œéœ€ç”¨ UNION æ¨¡æ‹Ÿï¼‰ã€‚
    \item \textbf{é™·é˜±}ï¼šå¦‚æœåœ¨ \texttt{WHERE} å­å¥ä¸­å¯¹å³è¡¨ï¼ˆLeft Join çš„è¢«è¿æ¥è¡¨ï¼‰çš„åˆ—åŠ æ¡ä»¶ï¼Œä¼šå°†å¤–è¿æ¥â€œé€€åŒ–â€ä¸ºå†…è¿æ¥ã€‚
    \begin{itemize}
        \item é”™è¯¯ï¼š\texttt{... LEFT JOIN B ON ... WHERE B.col = 1}
        \item æ­£ç¡®ï¼š\texttt{... LEFT JOIN B ON ... AND B.col = 1} ï¼ˆå¦‚æœæ˜¯è¿æ¥æ¡ä»¶ï¼‰æˆ–æ£€æŸ¥ \texttt{B.col IS NULL}ã€‚
    \end{itemize}
\end{itemize}

\subsection{5.2 é›†åˆæ“ä½œ (Set Operators)}
è¦æ±‚ä¸¤ä¸ªæŸ¥è¯¢ç»“æœçš„åˆ—æ•°ç›¸åŒï¼Œä¸”å¯¹åº”åˆ—çš„æ•°æ®ç±»å‹å…¼å®¹ã€‚
\begin{itemize}
    \item \textbf{UNION}ï¼šåˆå¹¶ç»“æœå¹¶\textbf{å»é‡}ã€‚
    \item \textbf{UNION ALL}ï¼šåˆå¹¶ç»“æœ\textbf{ä¸å»é‡}ã€‚æ•ˆç‡é€šå¸¸æ¯” UNION é«˜ï¼Œå› ä¸ºä¸éœ€è¦æ’åºå»é‡ã€‚å¦‚æœç¡®å®šæ— é‡å¤æˆ–éœ€è¦ä¿ç•™é‡å¤ï¼Œä¼˜å…ˆä½¿ç”¨æ­¤é¡¹ã€‚
    \item \textbf{INTERSECT}ï¼šäº¤é›†ï¼ˆä¸¤è¾¹éƒ½æœ‰çš„è¡Œï¼‰ã€‚
    \item \textbf{EXCEPT / MINUS}ï¼šå·®é›†ï¼ˆå·¦è¾¹æœ‰ä½†å³è¾¹æ²¡æœ‰çš„è¡Œï¼‰ã€‚
\end{itemize}

\subsection{5.3 å­æŸ¥è¯¢ (Subqueries)}
\begin{itemize}
    \item \textbf{æ ‡é‡å­æŸ¥è¯¢}ï¼šè¿”å›å•ä¸€å€¼çš„å­æŸ¥è¯¢ï¼Œå¯ç”¨åœ¨ \texttt{SELECT} åˆ—è¡¨æˆ– \texttt{WHERE} æ¯”è¾ƒä¸­ã€‚
    \item \textbf{IN / NOT IN}ï¼šåˆ¤æ–­å€¼æ˜¯å¦åœ¨åˆ—è¡¨ä¸­ã€‚
    \begin{warningbox}
    \textbf{NOT IN ä¸ NULL}ï¼šå¦‚æœå­æŸ¥è¯¢ç»“æœä¸­åŒ…å«ä»»ä½• NULL å€¼ï¼Œ\texttt{NOT IN} å°†æ°¸è¿œè¿”å›ç©ºç»“æœï¼ˆå› ä¸º \texttt{x <> NULL} æ˜¯ Unknownï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹åº”ä¼˜å…ˆä½¿ç”¨ \texttt{NOT EXISTS}ã€‚
    \end{warningbox}
    \item \textbf{EXISTS / NOT EXISTS}ï¼šæ£€æŸ¥å­æŸ¥è¯¢æ˜¯å¦è¿”å›è¡Œã€‚é€šå¸¸æ¯” \texttt{IN} æ€§èƒ½æ›´å¥½ï¼Œä¸”å¯¹ NULL å¤„ç†æ›´ç›´è§‚ã€‚
    \item \textbf{ç›¸å…³å­æŸ¥è¯¢ (Correlated Subquery)}ï¼šå­æŸ¥è¯¢å†…éƒ¨å¼•ç”¨äº†å¤–éƒ¨æŸ¥è¯¢çš„åˆ—ã€‚å¯¹æ¯ä¸€è¡Œå¤–éƒ¨æ•°æ®ï¼Œå­æŸ¥è¯¢éƒ½è¦æ‰§è¡Œä¸€æ¬¡ï¼ˆä½†åœ¨ç°ä»£ä¼˜åŒ–å™¨ä¸‹å¾€å¾€ä¼šè¢«ä¼˜åŒ–ä¸º Joinï¼‰ã€‚
\end{itemize}

\section{Chapter 6: æ’åºä¸çª—å£å‡½æ•° (Ordering and Window Functions)}

\subsection{6.1 æ’åº (ORDER BY)}
\begin{itemize}
    \item \texttt{ORDER BY col [ASC|DESC]}ã€‚
    \item å¤šåˆ—æ’åºï¼š\texttt{ORDER BY col1 ASC, col2 DESC}ã€‚
    \item \textbf{NULL æ’åº}ï¼šä¸åŒ DBMS å¤„ç†ä¸åŒã€‚Oracle é»˜è®¤ NULL æœ€å¤§ï¼ˆæ’æœ€åï¼‰ï¼ŒSQL Server é»˜è®¤ NULL æœ€å°ã€‚å¯ä½¿ç”¨ \texttt{NULLS FIRST/LAST} è¯­æ³•ï¼ˆå¦‚æœæ”¯æŒï¼‰ã€‚
    \item \textbf{åˆ†é¡µ}ï¼š
    \begin{itemize}
        \item MySQL/PG: \texttt{LIMIT x OFFSET y}
        \item SQL Server: \texttt{TOP x} æˆ– \texttt{OFFSET ... FETCH NEXT ...}
        \item Oracle: \texttt{ROWNUM} (æ—§) æˆ– \texttt{FETCH FIRST ...} (12c+)
    \end{itemize}
\end{itemize}

\subsection{6.2 çª—å£å‡½æ•° (Window Functions)}
ç”¨äºåœ¨ä¸èšåˆè¡Œçš„æƒ…å†µä¸‹è®¡ç®—èšåˆå€¼ï¼ˆå¦‚â€œæ¯è¡Œçš„ç´¯è®¡æ€»å’Œâ€ã€â€œæ¯è¡Œæ‰€å±ç»„çš„å¹³å‡å€¼â€ï¼‰ã€‚
\begin{itemize}
    \item è¯­æ³•ï¼š\texttt{Function() OVER (PARTITION BY ... ORDER BY ...)}
    \item \textbf{æ’åå‡½æ•°}ï¼š
    \begin{itemize}
        \item \texttt{ROW\_NUMBER()}ï¼š1, 2, 3, 4ï¼ˆå³ä½¿å€¼ç›¸åŒä¹Ÿå¼ºè¡Œæ’åºï¼Œæ— å¹¶åˆ—ï¼‰ã€‚
        \item \texttt{RANK()}ï¼š1, 2, 2, 4ï¼ˆæœ‰å¹¶åˆ—ï¼Œæ’åè·³è·ƒï¼‰ã€‚
        \item \texttt{DENSE\_RANK()}ï¼š1, 2, 2, 3ï¼ˆæœ‰å¹¶åˆ—ï¼Œæ’åè¿ç»­ï¼‰ã€‚
    \end{itemize}
    \item \textbf{èšåˆçª—å£}ï¼šå¦‚ \texttt{SUM(salary) OVER (PARTITION BY dept)} è®¡ç®—éƒ¨é—¨æ€»è–ªèµ„ï¼Œé™„åŠ åœ¨æ¯ä¸€åå‘˜å·¥è®°å½•åã€‚
\end{itemize}

\section{Chapter 7: æ¨¡ç³Šæœç´¢ä¸äº‹åŠ¡ (Fuzzy Search and Transactions)}

\subsection{7.1 æ¨¡ç³Šæœç´¢}
\begin{itemize}
    \item \textbf{é—®é¢˜}ï¼šTyposï¼ˆæ‹¼å†™é”™è¯¯ï¼‰ï¼Œä¸åŒè¯­è¨€çš„æ‹¼å†™å·®å¼‚ï¼ˆShenzhen vs Shenzenï¼‰ã€‚
    \item \textbf{è§£å†³æ–¹æ¡ˆ}ï¼š
    \begin{itemize}
        \item \texttt{LIKE}ï¼šç®€å•çš„æ¨¡å¼åŒ¹é…ï¼Œä½†æ— æ³•å¤„ç†æ‹¼å†™é”™è¯¯ï¼Œä¸” \texttt{\%abc} æ— æ³•åˆ©ç”¨ç´¢å¼•ã€‚
        \item \textbf{Soundex}ï¼šåŸºäºå‘éŸ³çš„ç®—æ³•ï¼ˆå¦‚å°†å§“åè½¬æ¢ä¸ºå‘éŸ³ä»£ç æ¯”è¾ƒï¼‰ã€‚
        \item \textbf{å…¨æ–‡æ£€ç´¢ (Full-text Search)}ï¼šåˆ†è¯ã€å€’æ’ç´¢å¼•ã€‚
        \item \textbf{è‡ªå®šä¹‰è·ç¦»}ï¼šå¦‚ Levenshtein Distanceï¼ˆç¼–è¾‘è·ç¦»ï¼‰ã€‚
    \end{itemize}
\end{itemize}

\subsection{7.2 äº‹åŠ¡ (Transactions)}
äº‹åŠ¡æ˜¯é€»è¾‘ä¸Šçš„ä¸€ç»„æ“ä½œï¼Œè¦ä¹ˆå…¨åšï¼Œè¦ä¹ˆå…¨ä¸åšã€‚
\begin{itemize}
    \item \textbf{ACID å±æ€§}ï¼š
    \begin{itemize}
        \item \textbf{A (Atomicity)}ï¼šåŸå­æ€§ï¼Œä¸å¯åˆ†å‰²ã€‚
        \item \textbf{C (Consistency)}ï¼šä¸€è‡´æ€§ï¼Œäº‹åŠ¡å‰åæ•°æ®éœ€æ»¡è¶³çº¦æŸã€‚
        \item \textbf{I (Isolation)}ï¼šéš”ç¦»æ€§ï¼Œå¹¶å‘äº‹åŠ¡äº’ä¸å¹²æ‰°ï¼ˆå­˜åœ¨éš”ç¦»çº§åˆ«ï¼‰ã€‚
        \item \textbf{D (Durability)}ï¼šæŒä¹…æ€§ï¼Œæäº¤åæ•°æ®ä¸ä¸¢å¤±ã€‚
    \end{itemize}
    \item \textbf{æ§åˆ¶è¯­å¥}ï¼š\texttt{BEGIN} (æˆ– \texttt{START TRANSACTION}), \texttt{COMMIT}, \texttt{ROLLBACK}ã€‚
    \item \textbf{Auto-commit}ï¼šå¾ˆå¤šæ•°æ®åº“é»˜è®¤æ¯æ¡è¯­å¥å°±æ˜¯ä¸€ä¸ªäº‹åŠ¡ï¼Œéœ€æ˜¾å¼å…³é—­æˆ–æ˜¾å¼å¼€å¯äº‹åŠ¡å—ã€‚
\end{itemize}

\subsection{7.3 æ•°æ®åŠ è½½ (Bulk Loading)}
\begin{itemize}
    \item é€æ¡ \texttt{INSERT} æ•ˆç‡æä½ã€‚
    \item åº”ä½¿ç”¨æ‰¹é‡åŠ è½½å·¥å…·ï¼ˆå¦‚ MySQL \texttt{LOAD DATA INFILE}, Oracle \texttt{SQL*Loader}, Postgres \texttt{COPY}ï¼‰ã€‚
    \item \textbf{ä¸»é”®ç”Ÿæˆ}ï¼š
    \begin{itemize}
        \item \textbf{Sequence} (Oracle, PG)ï¼šç‹¬ç«‹å¯¹è±¡ç”Ÿæˆæ•°å­—ã€‚
        \item \textbf{Auto Increment / Identity} (MySQL, SQL Server)ï¼šåˆ—å±æ€§è‡ªå¢ã€‚
    \end{itemize}
\end{itemize}

\section{Chapter 8: æ•°æ®ä¿®æ”¹ä¸å‡½æ•° (Update, Delete, Functions)}

\subsection{8.1 UPDATE ä¸ DELETE}
\begin{itemize}
    \item \textbf{UPDATE}ï¼š
    \begin{itemize}
        \item \texttt{UPDATE table SET col=val WHERE ...}
        \item \textbf{è‡´å‘½é”™è¯¯}ï¼šå¿˜è®°å†™ \texttt{WHERE} å­å¥ä¼šå¯¼è‡´å…¨è¡¨æ›´æ–°ã€‚
        \item ä½¿ç”¨å­æŸ¥è¯¢æ›´æ–°ï¼š\texttt{SET col = (SELECT ...)}ã€‚éœ€ç¡®ä¿å­æŸ¥è¯¢åªè¿”å›ä¸€è¡Œï¼Œå¦åˆ™æŠ¥é”™ã€‚
    \end{itemize}
    \item \textbf{DELETE}ï¼š
    \begin{itemize}
        \item \texttt{DELETE FROM table WHERE ...}
        \item é€è¡Œåˆ é™¤ï¼Œè®°å½•æ—¥å¿—ï¼Œå¯å›æ»šã€‚
    \end{itemize}
    \item \textbf{TRUNCATE}ï¼š
    \begin{itemize}
        \item DDL æ“ä½œï¼Œå¿«é€Ÿæ¸…ç©ºå…¨è¡¨ï¼Œé€šå¸¸ä¸å¯å›æ»šï¼ˆè§† DBMS å®ç°ï¼‰ï¼Œé‡ç½®è‡ªå¢ IDã€‚
    \end{itemize}
    \item \textbf{MERGE (Upsert)}ï¼š
    \begin{itemize}
        \item æ ‡å‡†è¯­æ³• \texttt{MERGE INTO target USING source ON match ... WHEN MATCHED UPDATE ... WHEN NOT MATCHED INSERT ...}ã€‚
        \item MySQL ä½¿ç”¨ \texttt{INSERT ... ON DUPLICATE KEY UPDATE}ã€‚
    \end{itemize}
\end{itemize}

\subsection{8.2 å­˜å‚¨å‡½æ•°ä¸è¿‡ç¨‹ (Functions \& Procedures)}
\begin{itemize}
    \item \textbf{å‡½æ•° (Function)}ï¼šå¿…é¡»æœ‰è¿”å›å€¼ï¼Œé€šå¸¸å¯ç”¨åœ¨ SQL è¯­å¥ä¸­ï¼ˆå¦‚ \texttt{SELECT my\_func(col)}ï¼‰ã€‚
    \item \textbf{è¿‡ç¨‹ (Procedure)}ï¼šå¯ä»¥æ²¡æœ‰è¿”å›å€¼ï¼Œé€šè¿‡ \texttt{CALL} æˆ– \texttt{EXECUTE} è°ƒç”¨ã€‚
    \item \textbf{N+1 é—®é¢˜}ï¼šåœ¨ SELECT åˆ—è¡¨ä¸­è°ƒç”¨æ‰§è¡ŒæŸ¥è¯¢çš„å‡½æ•°ï¼Œä¼šå¯¼è‡´æ¯ä¸€è¡Œéƒ½æ‰§è¡Œä¸€æ¬¡æŸ¥è¯¢ï¼Œæ€§èƒ½æå·®ã€‚åº”æ”¹å†™ä¸º Joinã€‚
\end{itemize}

\section{Chapter 9: è¿‡ç¨‹ä¸è§¦å‘å™¨ (Procedures and Triggers)}

\subsection{9.1 å­˜å‚¨è¿‡ç¨‹ä¼˜åŠ¿}
\begin{itemize}
    \item \textbf{æ€§èƒ½}ï¼šå‡å°‘ç½‘ç»œäº¤äº’ï¼ˆä¸€æ¬¡è°ƒç”¨ï¼ŒæœåŠ¡å™¨ç«¯æ‰§è¡Œå¤šæ­¥ï¼‰ã€‚
    \item \textbf{å®‰å…¨}ï¼šå¯ä»¥åªæˆäºˆç”¨æˆ·æ‰§è¡Œå­˜å‚¨è¿‡ç¨‹çš„æƒé™ï¼Œè€Œä¸æˆäºˆç›´æ¥ä¿®æ”¹è¡¨çš„æƒé™ã€‚
    \item \textbf{é€»è¾‘å°è£…}ï¼šä¸šåŠ¡é€»è¾‘é›†ä¸­åœ¨æ•°æ®åº“å±‚ã€‚
\end{itemize}

\subsection{9.2 è§¦å‘å™¨ (Triggers)}
åœ¨ç‰¹å®šçš„æ•°æ®åº“äº‹ä»¶ï¼ˆINSERT/UPDATE/DELETEï¼‰å‘ç”Ÿä¹‹å‰ï¼ˆBEFOREï¼‰æˆ–ä¹‹åï¼ˆAFTERï¼‰è‡ªåŠ¨æ‰§è¡Œçš„ä»£ç ã€‚
\begin{itemize}
    \item \textbf{ç”¨é€”}ï¼š
    \begin{itemize}
        \item å¼ºåˆ¶å¤æ‚çš„å®Œæ•´æ€§çº¦æŸã€‚
        \item å®¡è®¡ï¼ˆAuditingï¼‰ï¼šè®°å½•è°ä¿®æ”¹äº†æ•°æ®ã€‚
        \item è‡ªåŠ¨æ›´æ–°å†—ä½™æ•°æ®ï¼ˆå¦‚æ›´æ–°æ–‡ç« è¡¨æ—¶è‡ªåŠ¨æ›´æ–°åˆ†ç±»è¡¨çš„æ–‡ç« è®¡æ•°ï¼‰ã€‚
    \end{itemize}
    \item \textbf{é£é™©}ï¼š
    \begin{itemize}
        \item \textbf{éšè—é€»è¾‘}ï¼šå¼€å‘è€…å¯èƒ½ä¸çŸ¥é“æ•°æ®è¢«è§¦å‘å™¨ä¿®æ”¹äº†ã€‚
        \item \textbf{æ€§èƒ½æ€æ‰‹}ï¼šå¤§é‡è¡Œçº§è§¦å‘å™¨ï¼ˆFOR EACH ROWï¼‰ä¼šæ˜¾è‘—æ‹–æ…¢å†™å…¥é€Ÿåº¦ã€‚
        \item \textbf{æ­»å¾ªç¯}ï¼šAè¡¨è§¦å‘å™¨æ›´æ–°Bè¡¨ï¼ŒBè¡¨è§¦å‘å™¨æ›´æ–°Aè¡¨ã€‚
    \end{itemize}
    \item \textbf{å»ºè®®}ï¼šå°½é‡å°‘ç”¨ï¼Œé™¤éæ— æ³•é€šè¿‡çº¦æŸæˆ–åº”ç”¨å±‚é€»è¾‘è§£å†³ã€‚
\end{itemize}

\section{Chapter 10: å­˜å‚¨ä¸æ€§èƒ½ (Storage and Performance)}

\subsection{10.1 ç‰©ç†å­˜å‚¨ç»“æ„}
\begin{itemize}
    \item \textbf{å­˜å‚¨é‡‘å­—å¡”}ï¼šå¯„å­˜å™¨ > ç¼“å­˜ > å†…å­˜ > SSD > HDD > ç£å¸¦ã€‚é€Ÿåº¦è¶Šå¿«ï¼Œä»·æ ¼è¶Šé«˜ï¼Œå®¹é‡è¶Šå°ã€‚
    \item \textbf{RAID}ï¼šç£ç›˜é˜µåˆ—ã€‚
    \begin{itemize}
        \item RAID 0ï¼šæ¡å¸¦åŒ–ï¼Œé€Ÿåº¦å¿«ï¼Œæ— å†—ä½™ï¼ˆåä¸€å—ç›˜å…¨ä¸¢ï¼‰ã€‚
        \item RAID 1ï¼šé•œåƒï¼Œå®‰å…¨ï¼Œç©ºé—´åˆ©ç”¨ç‡50\%ã€‚
        \item RAID 5/10ï¼šå¹³è¡¡æ–¹æ¡ˆã€‚
    \end{itemize}
    \item \textbf{å—/é¡µ (Block/Page)}ï¼šæ•°æ®åº“I/Oçš„æœ€å°å•ä½ï¼ˆé€šå¸¸ 4KB, 8KB, 16KBï¼‰ã€‚è¯»å–ä¸€è¡Œæ•°æ®å®é™…ä¸Šé€šå¸¸ä¼šè¯»å–åŒ…å«è¯¥è¡Œçš„æ•´ä¸ªé¡µã€‚
\end{itemize}

\subsection{10.2 ç´¢å¼• (Indexing)}
ç´¢å¼•æ˜¯åŠ é€Ÿæ•°æ®æ£€ç´¢çš„æ•°æ®ç»“æ„ï¼ˆç±»ä¼¼äºä¹¦çš„ç›®å½•ï¼‰ã€‚
\begin{itemize}
    \item \textbf{B-Tree (Balanced Tree)}ï¼šæœ€å¸¸ç”¨çš„ç´¢å¼•ç»“æ„ã€‚ä¿æŒæ’åºï¼Œé€‚åˆèŒƒå›´æŸ¥æ‰¾ (\texttt{>, <, BETWEEN}) å’Œç­‰å€¼æŸ¥æ‰¾ã€‚
    \item \textbf{ç´¢å¼•å¤±æ•ˆ (Pitfalls)}ï¼š
    \begin{warningbox}
    ä»¥ä¸‹æƒ…å†µå¯èƒ½å¯¼è‡´ç´¢å¼•å¤±æ•ˆï¼ˆå…¨è¡¨æ‰«æï¼‰ï¼š
    1. \textbf{å¯¹ç´¢å¼•åˆ—ä½¿ç”¨å‡½æ•°}ï¼š\texttt{WHERE YEAR(date\_col) = 2020}ã€‚åº”æ”¹ä¸º \texttt{WHERE date\_col BETWEEN '2020-01-01' AND '2020-12-31'}ã€‚
    2. \textbf{éšå¼ç±»å‹è½¬æ¢}ï¼šå­—ç¬¦ä¸²åˆ—å­˜æ•°å­—ï¼ŒæŸ¥è¯¢æ—¶ç”¨æ•°å­—ç±»å‹æ¯”è¾ƒã€‚
    3. \textbf{å‰å¯¼æ¨¡ç³ŠæŸ¥è¯¢}ï¼š\texttt{LIKE '\%abc'}ã€‚
    4. \textbf{è”åˆç´¢å¼•ä¸æ»¡è¶³æœ€å·¦å‰ç¼€åŸåˆ™}ï¼šç´¢å¼•æ˜¯ (A, B)ï¼ŒæŸ¥è¯¢æ¡ä»¶åªæœ‰ Bã€‚
    \end{warningbox}
    \item \textbf{é€‰æ‹©æ€§ (Selectivity)}ï¼šç´¢å¼•åœ¨â€œåŒºåˆ†åº¦é«˜â€çš„åˆ—ä¸Šæœ€æœ‰æ•ˆï¼ˆå¦‚èº«ä»½è¯å·ï¼‰ã€‚åœ¨â€œæ€§åˆ«â€è¿™ç§åªæœ‰ä¸¤ä¸ªå€¼çš„åˆ—ä¸Šå»ºç«‹ç´¢å¼•é€šå¸¸æ— æ„ä¹‰ã€‚
    \item \textbf{ä»£ä»·}ï¼šåŠ å¿«äº†è¯»å–ï¼Œå‡æ…¢äº†å†™å…¥ï¼ˆINSERT/UPDATE/DELETE éœ€è¦ç»´æŠ¤ç´¢å¼•æ ‘ï¼‰ã€‚
\end{itemize}

\subsection{10.3 æ‰§è¡Œè®¡åˆ’ (Execution Plan)}
\begin{itemize}
    \item ä½¿ç”¨ \texttt{EXPLAIN} å‘½ä»¤æŸ¥çœ‹æ•°æ®åº“å¦‚ä½•æ‰§è¡Œ SQLã€‚
    \item å…³é”®çœ‹ç‚¹ï¼šæ˜¯å¦ä½¿ç”¨äº†ç´¢å¼• (Index Scan/Seek) è¿˜æ˜¯ å…¨è¡¨æ‰«æ (Full Table Scan/Seq Scan)ã€‚
\end{itemize}

\end{document}